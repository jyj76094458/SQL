SELECT ITEM_PREFIX||ITEM_CODE AS ITEM
FROM PRO_RECALL_ITEM;

SELECT * FROM T1 WHERE 도시개발사 LIKE '%울%';
SELECT * FROM T1 WHERE 도시개발사 LIKE '%건설%';
SELECT * FROM T1 WHERE 도시개발사 IN('하울','카울');
SELECT * FROM T1 WHERE 도시개발사 NOT IN('하울','카울');
SELECT * FROM T1 WHERE 도시개발사='하울팀' AND '카울팀';

SELECT AP2ID
FROM KOPO_CHANNEL_RESULT;

SELECT DISTINCT AP2ID
FROM KOPO_CHANNEL_RESULT;

SELECT DISTINCT AP2ID
FROM KOPO_CHANNEL_RESULT
WHERE 1=1
AND AP2ID IS NOT NULL;

SELECT *
FROM KOPO_CHANNEL_RESULT
WHERE 1=1
AND AP1NAME = 'WEST'
AND YEARWEEK >= 201720;

SELECT DISTINCT ACCOUNTID
FROM KOPO_CHANNEL_RESULT
WHERE 1=1
AND AP1NAME = 'WEST'
AND YEARWEEK >= 201720;

SELECT
REGIONID||'_'||PRODUCTGROUP AS IDX,
B.*
FROM
(SELECT * FROM
KOPO_PRODUCT_VOLUME
WHERE REGIONID = 'A01'
AND PRODUCTGROUP = 'ST0001'
AND YEARWEEK >= '201501'
ORDER BY YEARWEEK ASC
) B

SELECT REGIONID||'_'||PRODUCTGROUP AS IDX,
REGIONID,
PRODUCTGROUP,
YEARWEEK,
VOLUME
FROM KOPO_PRODUCT_VOLUME

SELECT CONCAT(REGIONID,CONCAT('_',PRODUCTGROUP)) AS IDX
FROM KOPO_PRODUCT_VOLUME

SELECT A.REGIONID||'_'||A.PRODUCTGROUP AS IDX, A.*
FROM KOPO_PRODUCT_VOLUME A;

SELECT 'A01_ST0001' AS IDX
			, REGIONID
			, PRODUCTGROUP
			, YEARWEEK
			, VOLUME
FROM KOPO_PRODUCT_VOLUME;

SELECT *
FROM KOPO_PRODUCT_VOLUME

SELECT A.REGIONID||A.PRODUCTGROUP
			,A.*
FROM KOPO_PRODUCT_VOLUME A

SELECT REGIONID||'_'||PRODUCTGROUP AS IDX, REGIONID, PRODUCTGROUP, YEARWEEK, VOLUME
FROM KOPO_PRODUCT_VOLUME
WHERE YEARWEEK BETWEEN 201501 AND 201507
ORDER BY PRODUCTGROUP,YEARWEEK,VOLUME ASC;

SELECT REGIONSEG
		 , SALESID
		 , PRODUCTGROUP
		 , ITEM
		 , TARGETWEEK
		 , PLANWEE
		 , MAP_PRICE
		 , IR
		 , PMAP
		 , PMAP10
		 , PRO_PERCENT
FROM PRO_PROMOTION
WHERE ITEM IN (SELECT ITEM_PREFIX||ITEM_CODE FROM PRO_RECALL_ITEM);

SELECT *
FROM PRO_PROMOTION

SELECT COUNT(*)
FROM (
	SELECT DISTINCT ITEM
	FROM PRO_PROMOTION
)

SELECT *
FROM PRO_RECALL_ITEM

SELECT A.*
FROM PRO_PROMOTION A
WHERE 1=1
AND A.ITEM IN ('ITEM0211')

SELECT ITEM_PREFIX||ITEM_CODE
FROM PRO_RECALL_ITEM

SELECT A.*
FROM PRO_PROMOTION A
WHERE 1=1
AND A.ITEM IN ( SELECT ITEM_PREFIX||ITEM_CODE AS ITEM2
		FROM PRO_RECALL_ITEM)

SELECT A.*
FROM PRO_PROMOTION A
WHERE 1=1
AND A.ITEM IN ( SELECT ITEM_PREFIX||ITEM_CODE AS ITEM2
		FROM PRO_RECALL_ITEM)
AND A.REGIONID IN (
		SELECT REGIONID
		FROM REGION_MST
		WHERE 1=1
		AND ACTIVATE_ENABLE = 'Y')

SELECT REGIONID,
	PRODUCTGROUP,
	YEARWEEK
FROM KOPO_PRODUCT_VOLUME
WHERE 1=1
AND PRODUCTGROUP = 'ST0001'

SELECT REGIONID,
	PRODUCTGROUP,
	YEARWEEK
FROM KOPO_PRODUCT_VOLUME
WHERE 1=1
AND PRODUCTGROUP = &inproduct

SELECT REGIONID,
PRODUCTGROUP,
YEARWEEK
FROM KOPO_PRODUCT_VOLUME
WHERE 1=1
AND PRODUCTGROUP = &inproduct
AND REGIONID = &inregion

SELECT *
FROM KOPO_PRODUCT_VOLUME

SELECT *
FROM KOPO_PRODUCT_VOLUME
ORDER BY REGIONID, PRODUCTGROUP, YEARWEEK

SELECT *
FROM KOPO_PRODUCT_VOLUME
ORDER BY REGIONID DESC, PRODUCTGROUP ASC, YEARWEEK ASC

CREATE TABLE ORDER_NO
(
 SEQ_VARNO VARCHAR2(100)
 ,SEQ_NO NUMBER
 ,CONTENTS VARCHAR2(100)
)

EDIT ORDER_NO

SELECT *
FROM ORDER_NO
ORDER BY SEQ_VARNO

SELECT *
FROM ORDER_NO
ORDER BY SEQ_NO

SELECT *
FROM ORDER_NO
ORDER BY LPAD(SEQ_VARNO,2,'0')

SELECT LPAD(SEQ_VARNO,2,'0')
FROM ORDER_NO

SELECT *
FROM KOPO_CHANNEL_RESULT

SELECT *
FROM KOPO_CHANNEL_RESULT
WHERE 1=1
AND PRODUCTGROUP = 'TV'

CREATE TABLE KOPO_CHANNEL_RESULT_TV AS
SELECT *
FROM KOPO_CHANNEL_RESULT
WHERE 1=1
AND PRODUCTGROUP = 'TV'

CREATE TABLE KOPO_CHANNEL_RESULT_TV_JYJ AS
SELECT *
FROM KOPO_CHANNEL_RESULT
WHERE 1=1
AND PRODUCTGROUP = 'TV'

CREATE TABLE KOPO_CHANNEL_RESULT_REF_JYJ AS
SELECT *
FROM KOPO_CHANNEL_RESULT
WHERE 1=1
AND PRODUCTGROUP = 'REF'

SELECT *
FROM KOPO_CHANNEL_RESULT_TV_JYJ
UNION
SELECT *
FROM KOPO_CHANNEL_RESULT_REF_JYJ

CREATE TABLE KOPO_CHANNEL_RESULT_UNION_JYJ AS
SELECT *
FROM KOPO_CHANNEL_RESULT_TV_JYJ
UNION
SELECT *
FROM KOPO_CHANNEL_RESULT_REF_JYJ

SELECT *
FROM KOPO_CHANNEL_RESULT_UNION_JYJ

SELECT *
FROM KOPO_CHANNEL_RESULT_UNION_JYJ
UNION ALL
SELECT *
FROM KOPO_CHANNEL_RESULT

SELECT *
FROM KOPO_CHANNEL_RESULT_UNION_JYJ
UNION
SELECT *
FROM KOPO_CHANNEL_RESULT

CTRL + E -> COST 계산

SELECT A.*
FROM KOPO_PRODUCT_VOLUME A

SELECT A.*,
	SYSDATE AS DATE_NOW
FROM KOPO_PRODUCT_VOLUME A

SELECT A.*,
	SYSDATE AS DATE_NOW,
	NEXT_DAY(SYSDATE,2) AS NEXT_BATCH_TIME
FROM KOPO_PRODUCT_VOLUME A

SELECT A.*,
	SYSDATE AS DATE_NOW,
	 NEXT_DAY(SYSDATE,3) AS NEXT_BATCH_TIME,
	LAST_DAY(SYSDATE) AS MONTH_LAST
FROM KOPO_PRODUCT_VOLUME A

SELECT TO_CHAR(SYSDATE-7, 'YYYYWW') FROM DUAL
SELECT TO_CHAR(SYSDATE, 'YYYYWW') FROM DUAL
SELECT TO_CHAR(SYSDATE-30, 'YYYYMMDD') FROM DUAL
SELECT TO_CHAR(SYSDATE, 'YYYYMMDD') FROM DUAL
SELECT TO_CHAR(SYSDATE-1, 'YYYYMMDD') FROM DUAL

SELECT TO_CHAR(SYSDATE+2, 'YYYYMMDD')
			 FROM DUAL

SELECT TO_CHAR(SYSDATE, 'YYYY-MM-DD') AS DT
FROM DUAL

SELECT *
FROM ORDER_NO
ORDER BY TO_NUMBER( SEQ_VARNO )

SELECT
	YEARWEEK,
	CASE WHEN QTY<1000 THEN 1000
		WHEN QTY>1000 AND QTY <10000 THEN 10000
		ELSE 30000 END AS QTY
FROM KOPO_CHANNEL_SEASONALITY_NEW

SELECT *
FROM KOPO_CHANNEL_SEASONALITY_NEW

SELECT A.*,
	CASE WHEN A.QTY < 1000 THEN 1000
	 WHEN A.QTY < 10000 THEN 10000
	ELSE 30000 END
FROM KOPO_CHANNEL_SEASONALITY A

SELECT A.*,
	CASE WHEN A.QTY < 1000 THEN 1000
	WHEN A.QTY < 10000 THEN 10000
	ELSE 30000 END AS NEW_QTY
FROM KOPO_CHANNEL_SEASONALITY A
WHERE A.QTY < 1000

---- 에러 뜨는 쿼리 -----

SELECT A.*,
	CASE WHEN A.QTY < 1000 THEN 1000
	WHEN A.QTY < 10000 THEN 10000
	ELSE 30000 END AS NEW_QTY
FROM KOPO_CHANNEL_SEASONALITY A
WHERE 1=1
AND A.QTY < 1000
AND NEW_QTY != 1000

--------------------------

SELECT B.*
FROM (
	SELECT A.*,
	CASE WHEN A.QTY < 1000 THEN 1000
	WHEN A.QTY < 10000 THEN 10000
	ELSE 30000 END AS NEW_QTY
	FROM KOPO_CHANNEL_SEASONALITY A
	WHERE 1=1
	AND A.QTY < 1000
) B
WHERE 1=1
AND B.NEW_QTY != 1000

SELECT C.*
FROM(
	SELECT B.*,
	 SUBSTR(B.YEARWEEK,1,4) AS YEAR
	FROM(
	SELECT A.*,
	CASE WHEN A.QTY < 1000 THEN 1000
	WHEN A.QTY < 10000 THEN 10000
	ELSE 30000 END AS NEW_QTY
	FROM KOPO_CHANNEL_SEASONALITY A
	WHERE 1=1
	AND A.QTY < 1000
	) B
	WHERE 1=1
) C
WHERE 1=1
AND C.YEAR < 2015

SELECT C.*
FROM (
	SELECT B.*,
	SUBSTR(B.YEARWEEK,1,4) AS YEAR
	FROM(
		SELECT A.*,
		CASE WHEN A.QTY < 1000 THEN 1000
		WHEN A.QTY < 10000 THEN 10000
		ELSE 30000 END AS NEW_QTY
		FROM KOPO_CHANNEL_SEASONALITY A
		WHERE 1=1
		AND A.QTY < 1000
	) B
	WHERE 1=1
	AND SUBSTR(B.YEARWEEK, 1, 4) < 2014
) C
WHERE 1=1
AND C.YEAR < 2015;

SELECT *
FROM DT_RESULT_FINAL3;

SELECT CUSTOMERCODE
      ,STATENAME
      ,ST
      ,GENDER
      ,DOB
      ,GENDER1
      ,EMAIL
      ,FEST_CNT
      ,TOTAL_AMOUNT
      ,AC_AMOUNT
      ,AV_AMOUNT
      ,HA_AMOUNT
      ,EMI_CE_AMOUNT
      ,IS_HIGHEND
      ,CNT_VIST
      ,GAP_VISIT,
       CASE WHEN TOTAL_AMOUNT > 100000 THEN 'HIGH'
            ELSE 'LOW' END AS CUSTOMER_SEG
FROM KOPO_CUSTOMERDATA;

SELECT PRODUCTGROUP
      ,PRODUCT
      ,ITEM
      ,YEARWEEK
      ,REAL_QTY
      ,PREDICTION_QTY
      ,CASE WHEN PREDICTION_QTY > 0 THEN 1-ABS(PREDICTION_QTY-REAL_QTY)/PREDICTION_QTY
      ELSE 0 END AS 정확도
FROM DT_RESULT_FINAL3;